select
    cast(cds as string) as Cds,
    rtype as RType,
    schoolname as SchoolName,
    districtname as DistrictName,
    countyname as CountyName,
    charter_flag as CharterFlag,
    coe_flag as CoeFlag,
    dass_flag as DassFlag,
    studentgroup as StudentGroup,
    studentgroup_pct as StudentGroupPct,
    currdenom as CurrDenom,
    currstatus as CurrStatus,
    priordenom as PriorDenom,
    priorstatus as PriorStatus,
    change as Change,
    statuslevel as StatusLevel,
    changelevel as ChangeLevel,
    color as Color,
    box as Box,
    curr_prep as CurrPrep,
    curr_prep_pct as CurrPrepPct,
    curr_prep_summative as CurrPrepSummative,
    curr_prep_summative_pct as CurrPrepSummativePct,
    curr_prep_apexam as CurrPrepApExam,
    curr_prep_apexam_pct as CurrPrepApExamPct,
    curr_prep_ibexam as CurrPrepIbExam,
    curr_prep_ibexam_pct as CurrPrepIbExamPct,
    curr_prep_collegecredit as CurrPrepCollegeCredit,
    curr_prep_collegecredit_pct as CurrPrepCollegeCreditPct,
    curr_prep_agplus as CurrPrepAgPlus,
    curr_prep_agplus_pct as CurrPrepAgPlusPct,
    curr_prep_cteplus as CurrPrepCtePlus,
    curr_prep_cteplus_pct as CurrPrepCtePlusPct,
    curr_prep_ssb as CurrPrepSsb,
    curr_prep_ssb_pct as CurrPrepSsbPct,
    curr_prep_milsci as CurrPrepMilSci,
    curr_prep_milsci_pct as CurrPrepMilSciPct,
    curr_aprep as CurrAPrep,
    curr_aprep_pct as CurrAPrepPct,
    curr_aprep_summative as CurrAPrepSummative,
    curr_aprep_summative_pct as CurrAPrepSummativePct,
    curr_aprep_collegecredit as CurrAPrepCollegeCredit,
    curr_aprep_collegecredit_pct as CurrAPrepCollegeCreditPct,
    curr_aprep_ag as CurrAPrepAg,
    curr_aprep_ag_pct as CurrAPrepAgPct,
    curr_aprep_cte as CurrAPrepCte,
    curr_aprep_cte_pct as CurrAPrepCtePct,
    curr_aprep_milsci as CurrAPrepMilSci,
    curr_aprep_milsci_pct as CurrAPrepMilSciPct,
    curr_nprep as CurrNPrep,
    curr_nprep_pct as CurrNPrepPct,
    prior_prep as PriorPrep,
    prior_prep_pct as PriorPrepPct,
    prior_prep_summative as PriorPrepSummative,
    prior_prep_summative_pct as PriorPrepSummativePct,
    prior_prep_apexam as PriorPrepApExam,
    prior_prep_apexam_pct as PriorPrepApExamPct,
    prior_prep_ibexam as PriorPrepIbExam,
    prior_prep_ibexam_pct as PriorPrepIbExamPct,
    prior_prep_collegecredit as PriorPrepCollegeCredit,
    prior_prep_collegecredit_pct as PriorPrepCollegeCreditPct,
    prior_prep_agplus as PriorPrepAgPlus,
    prior_prep_agplus_pct as PriorPrepAgPlusPct,
    prior_prep_cteplus as PriorPrepCtePlus,
    prior_prep_cteplus_pct as PriorPrepCtePlusPct,
    prior_prep_ssb as PriorPrepSsb,
    prior_prep_ssb_pct as PriorPrepSsbPct,
    prior_prep_milsci as PriorPrepMilSci,
    prior_prep_milsci_pct as PriorPrepMilSciPct,
    prior_aprep as PriorAPrep,
    prior_aprep_pct as PriorAPrepPct,
    prior_aprep_summative as PriorAPrepSummative,
    prior_aprep_summative_pct as PriorAPrepSummativePct,
    prior_aprep_collegecredit as PriorAPrepCollegeCredit,
    prior_aprep_collegecredit_pct as PriorAPrepCollegeCreditPct,
    prior_aprep_ag as PriorAPrepAg,
    prior_aprep_ag_pct as PriorAPrepAgPct,
    prior_aprep_cte as PriorAPrepCte,
    prior_aprep_cte_pct as PriorAPrepCtePct,
    prior_aprep_milsci as PriorAPrepMilSci,
    prior_aprep_milsci_pct as PriorAPrepMilSciPct,
    prior_nprep as PriorNPrep,
    prior_nprep_pct as PriorNPrepPct,
    reportingyear as ReportingYear
from {{ source('RawData', 'CaDashCci2018') }}
where
    rtype = 'X'
    --ESUHSD (includes ACE Charter High)
    or substr(cast(cds as string), 1, 7) = '4369427'
